---
title: "Topic 3: Adding images"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
  
pdftools::pdf_text

#Overview
Sentiment analysis is a tool for assessing the mood of a piece of text. For example, we can use sentiment analysis to understand public perceptions of topics in environmental policy like energy, climate, and conservation.

```{r}
library(tidyr) #text analysis in R
library(lubridate) #working wtih date data
library(scales) #?
library(pdftools) #read in the pdfs
library(tidyverse)
library(tidytext)
library(here)
```


##Intro sentiment analysis example
```{r toy_data}

over <- pdf_text('dat/overstory_exerpt.pdf')
over_df <- data.frame(text = over) %>% #create 1-column df with 'text' variable
  mutate(page = 1:n()) #add a page number variable, 'page'

over_main <- over_df %>%
  filter(page %in% 8:41)%>%
  mutate(text = str_split(text, '\n')) %>%
  unnest(text)

```

```{r}

to_write <- over_main %>% mutate(lower = str_to_lower(text))

write_csv(to_write, "dat/over_text.csv")

bing_sent <- get_sentiments('bing') #grab the bing sentiment lexicon from tidytext

# The steps here:
#
# * Break the entire text into individual words
# * Eliminate stop words (using `dplyr::anti_join` is handy here)
# * Attach sentiment scores by word (using `dplyr::inner_join` is handy here)

# ```{r}
# over_text <- read_csv('dat/over_text.csv')
#
# #unnest to word-level tokens, remove stop words, and join sentiment words
# text_words <- over_text  %>%
#   unnest_tokens(output = word, input = text, token = 'words') %>%
#   anti_join(stop_words, by = 'word') %>%
#   inner_join(bing_sent, by = 'word')
#
# ```

#
# ```{r apply-sent-scores, eval=FALSE}
# text_scores <- text_words %>%
#   count(sentiment, page) %>%
#   spread(sentiment, page) %>%
#   mutate(raw_score    = positive - negative,
#          offset       = mean(positive - negative),
#          offset_score = (positive - negative) - offset) %>%
#   arrange(desc(raw_score)) %>%
#   mutate(ch = fct_inorder())
# ```


## IPCC Tweets
# What is the IPCC report?
# https://www.bbc.com/news/science-environment-60987614
```

<!-- Here is the query I used for gathering Twitter data -->
<!-- Post-report data -->

```{r inspect_tweets_data}

```

<!-- Pre-report data -->
<!-- Comparison -->
